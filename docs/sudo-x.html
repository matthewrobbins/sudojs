<!DOCTYPE html>  <html> <head>   <title>sudo-x.js</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               sudo-x.js             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nb">window</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <h1>Sudo Namespace</h1>             </td>             <td class="code">               <div class="highlight"><pre><span class="kd">var</span> <span class="nx">sudo</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Namespace for <code>Delegate</code> Class Objects used to delegate functionality
from a <code>delegator</code></p>

<p><code>namespace</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">delegates</span><span class="o">:</span> <span class="p">{},</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <h3>extend</h3>

<p>Copy the (non-inherited) key:value pairs from <n> source objects to a single target object.</p>

<p><code>params</code> {objects} A target object followed by <n> source objects</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">extend</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">extend</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">),</span>
      <span class="nx">targ</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">obj</span><span class="p">,</span> <span class="nx">keys</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>iterate over each passed in obj remaining</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">for</span><span class="p">(</span><span class="nx">obj</span><span class="p">;</span> <span class="nx">args</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">obj</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">shift</span><span class="p">());)</span> <span class="p">{</span>
      <span class="nx">keys</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
      <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">keys</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">targ</span><span class="p">[</span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">keys</span><span class="p">[</span><span class="nx">i</span><span class="p">]];</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">targ</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>The sudo.extensions namespace holds the objects that are stand alone <code>modules</code> which
can be <code>implemented</code> (mixed-in) in sudo Class Objects</p>

<p><code>namespace</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">extensions</span><span class="o">:</span> <span class="p">{},</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <h3>getPath</h3>

<p>Extract a value located at <code>path</code> relative to the passed in object</p>

<p><code>param</code> {string} <code>path</code>. The key in the form of a dot-delimited path.
<code>param</code> {object} <code>obj</code>. An object literal to operate on.</p>

<p><code>returns</code> {*|undefined}. The value at keypath or undefined if not found.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">getPath</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">getPath</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">p</span><span class="p">;</span>
    <span class="nx">p</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">);</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">key</span><span class="p">;</span> <span class="nx">p</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">key</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">shift</span><span class="p">());)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">p</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">obj</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">||</span> <span class="p">{};</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <h3>inherit</h3>

<p>Inherit the prototype from a parent to a child.
Set the childs constructor for subclasses of child.
Subclasses of the library base classes will not 
want to use this function in <em>most</em> use-cases. Why? User Sudo Class Objects
possess their own constructors and any call back to a <code>superclass</code> constructor
will generally be looking for the library Object's constructor.</p>

<p><code>param</code> {function} <code>parent</code>
<code>param</code> {function} <code>child</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">inherit</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">inherit</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="nx">child</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">child</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">parent</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span>
    <span class="nx">child</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">constructor</span> <span class="o">=</span> <span class="nx">child</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <h3>makeMeASandwich</h3>

<p>Notice there is no need to extrinsically instruct <em>how</em> to
make the sandwich, just the elegant single command.</p>

<p><code>returns</code> {string}</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">makeMeASandwich</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">makeMeASandwich</span><span class="p">()</span> <span class="p">{</span><span class="k">return</span> <span class="s1">&#39;Okay.&#39;</span><span class="p">;},</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <h3>namespace</h3>

<p>Method for assuring a Namespace is defined.</p>

<p><code>param</code> {string} <code>path</code>. The path that leads to a blank Object.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">namespace</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">namespace</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">getPath</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nb">window</span><span class="p">))</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setPath</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="p">{},</span> <span class="nb">window</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <h3>noop</h3>

<p>A blank function used as a placeholder for virtual methods meant to be overridden
by subclassing</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">noop</span><span class="o">:</span> <span class="kd">function</span><span class="p">(){},</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <h3>premier</h3>

<p>The premier object takes precedence over all others so define it at the topmost level.</p>

<p><code>type</code> {Object}</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">premier</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <h3>setPath</h3>

<p>Traverse the keypath and get each object 
(or make blank ones) eventually setting the value 
at the end of the path</p>

<p><code>param</code> {string} <code>path</code>. The path to traverse when setting a value.
<code>param</code> {*} <code>value</code>. What to set.
<code>param</code> {Object} <code>obj</code>. The object literal to operate on.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">setPath</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">setPath</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">),</span> <span class="nx">key</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">key</span><span class="p">;</span> <span class="nx">p</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">key</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">shift</span><span class="p">());)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">p</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="p">{</span>
        <span class="nx">obj</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">obj</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <h4>uid</h4>

<p>Some sudo Objects use a unique integer as a <code>tag</code> for identification.
(Views for example). This ensures they are indeed unique.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">uid</span><span class="o">:</span> <span class="mi">0</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <h4>unique</h4>

<p>An integer used as 'tags' by some sudo Objects as well
as a unique string for views when needed</p>

<p><code>param</code> {string} prefix. Optional string identifier</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">unique</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">unique</span><span class="p">(</span><span class="nx">prefix</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">prefix</span> <span class="o">?</span> <span class="nx">prefix</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">uid</span><span class="o">++</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">uid</span><span class="o">++</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <h3>unsetPath</h3>

<p>Remove a key:value pair from this object's data store
located at <path></p>

<p><code>param</code> {String} <code>path</code>
<code>param</code> {Object} <code>obj</code> The object to operate on.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">unsetPath</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">unsetPath</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">p</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">),</span> <span class="nx">key</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">key</span><span class="p">;</span> <span class="nx">p</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">key</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">shift</span><span class="p">());)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">p</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">delete</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>this can fail if a faulty path is passed.
using getPath beforehand can prevent that</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">obj</span> <span class="o">=</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <h2>Base Class Object</h2>

<p>All sudo.js objects inherit base, giving the ability
to utilize delegation, the <code>base</code> function and the 
<code>construct</code> convenience method.</p>

<p><code>constructor</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Base</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>can delegate</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">delegates</span> <span class="o">=</span> <span class="p">[];</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>a beautiful and unique snowflake</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">uid</span> <span class="o">=</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">unique</span><span class="p">();</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <h3>addDelegate</h3>

<p>Push an instance of a Class Object into this object's <code>_delegates_</code> list.</p>

<p><code>param</code> {Object} an instance of a sudo.delegates Class Object
<code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">addDelegate</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">addDelegate</span><span class="p">(</span><span class="nx">del</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">del</span><span class="p">.</span><span class="nx">delegator</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">delegates</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">del</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <h3>base</h3>

<p>Lookup the function matching the name passed in  and call it with
any passed in argumets scoped to the calling object.
This method will avoid the recursive-loop problem by making sure
that the first match is not the function that called <code>base</code>.</p>

<p><code>params</code> {*} any other number of arguments to be passed to the looked up method
along with the initial method name</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">base</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">base</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">),</span>
    <span class="nx">name</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">shift</span><span class="p">(),</span> 
    <span class="nx">found</span> <span class="o">=</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">obj</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
    <span class="nx">curr</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>find method on the prototype, excluding the caller</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nx">found</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">curr</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">curr</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">curr</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">!==</span> <span class="k">this</span><span class="p">[</span><span class="nx">name</span><span class="p">])</span> <span class="nx">found</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>keep digging</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">else</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">curr</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">curr</span><span class="p">[</span><span class="nx">name</span><span class="p">].</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <h3>construct</h3>

<p>A convenience method that alleviates the need to place:
<code>Object.getPrototypeOf(this).consturctor.apply(this, arguments)</code>
in every constructor</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">construct</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">construct</span><span class="p">()</span> <span class="p">{</span>
  <span class="nb">Object</span><span class="p">.</span><span class="nx">getPrototypeOf</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">constructor</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span> <span class="o">||</span> <span class="p">[]);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <h3>delegate</h3>

<p>From this object's list of delegates find the object whose <code>_role_</code> matches
the passed <code>name</code> and:
1. if <code>meth</code> is falsy return the delegate.
2 if <code>meth</code> is truthy bind its method (to the delegate) and return the method</p>

<p><code>param</code> {String} <code>role</code> The role property to match in this object's delegates list
<code>param</code> {String} <code>meth</code> Optional method to bind to the action this delegate is being used for
<code>returns</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">delegate</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">delegate</span><span class="p">(</span><span class="nx">role</span><span class="p">,</span> <span class="nx">meth</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">del</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">delegates</span><span class="p">,</span> <span class="nx">i</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">del</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">del</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">role</span> <span class="o">===</span> <span class="nx">role</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">meth</span><span class="p">)</span> <span class="k">return</span> <span class="nx">del</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
      <span class="k">return</span> <span class="nx">del</span><span class="p">[</span><span class="nx">i</span><span class="p">][</span><span class="nx">meth</span><span class="p">].</span><span class="nx">bind</span><span class="p">(</span><span class="nx">del</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <h3>getDelegate</h3>

<p>Fetch a delegate whose role property matches the passed in argument.
Uses the <code>delegate</code> method in its 'single argument' form, included for 
API consistency</p>

<p><code>param</code> {String} <code>role</code>
'returns' {Object|undefined}</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getDelegate</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">getDelegate</span><span class="p">(</span><span class="nx">role</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">delegate</span><span class="p">(</span><span class="nx">role</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <h3>removeDelegate</h3>

<p>From this objects <code>delegates</code> list remove the object (there should only ever be 1)
whose role matches the passed in argument</p>

<p><code>param</code> {String} <code>role</code>
<code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">removeDelegate</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">removeDelegate</span><span class="p">(</span><span class="nx">role</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">del</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">delegates</span><span class="p">,</span> <span class="nx">i</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">del</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">del</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">role</span> <span class="o">===</span> <span class="nx">role</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>no <em>delegator</em> for you</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">del</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">delegator</span> <span class="o">=</span> <span class="k">void</span> <span class="mi">0</span><span class="p">;</span>
      <span class="nx">del</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-30">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-30">&#182;</a>               </div>               <p><code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">role</span> <span class="o">=</span> <span class="s1">&#39;base&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-31">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-31">&#182;</a>               </div>               <h2>Model Class Object</h2>

<p>Model Objects expose methods for setting and getting data, and
can be observed if implementing the <code>Observable Extension</code></p>

<p><code>param</code> {object} data. An initial state for this model.</p>

<p><code>constructor</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Model</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">sudo</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">data</span> <span class="o">||</span> <span class="p">{};</span></pre></div>             </td>           </tr>                               <tr id="section-32">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-32">&#182;</a>               </div>               <p>only models are <code>observable</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">callbacks</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">changeRecords</span> <span class="o">=</span> <span class="p">[];</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-33">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-33">&#182;</a>               </div>               <p>Model inherits from sudo.Base
<code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">inherit</span><span class="p">(</span><span class="nx">sudo</span><span class="p">.</span><span class="nx">Base</span><span class="p">,</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">Model</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-34">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-34">&#182;</a>               </div>               <h3>get</h3>

<p>Returns the value associated with a key.</p>

<p><code>param</code> {String} <code>key</code>. The name of the key
<code>returns</code> {*}. The value associated with the key or false if not found.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">get</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">get</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-35">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-35">&#182;</a>               </div>               <h3>getPath</h3>

<p>Uses the sudo namespace's getpath function operating on the model's
data hash.</p>

<p><code>returns</code> {*|undefined}. The value at keypath or undefined if not found.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getPath</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">getPath</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">getPath</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-36">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-36">&#182;</a>               </div>               <h3>gets</h3>

<p>Assembles and returns an object of key:value pairs for each key
contained in the passed in Array.</p>

<p><code>param</code> {array} <code>ary</code>. An array of keys.
<code>returns</code> {object}</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">gets</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">gets</span><span class="p">(</span><span class="nx">ary</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ary</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">obj</span><span class="p">[</span><span class="nx">ary</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">ary</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">ary</span><span class="p">[</span><span class="nx">i</span><span class="p">]]</span> <span class="o">:</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">getPath</span><span class="p">(</span><span class="nx">ary</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-37">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-37">&#182;</a>               </div>               <p><code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">role</span> <span class="o">=</span> <span class="s1">&#39;model&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-38">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-38">&#182;</a>               </div>               <h3>set</h3>

<p>Set a key:value pair.</p>

<p><code>param</code> {String} <code>key</code>. The name of the key.
<code>param</code> {*} <code>value</code>. The value associated with the key.
<code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">set</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">set</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-39">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-39">&#182;</a>               </div>               <p><em>NOTE: intentional possibilty of setting a falsy value</em></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-40">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-40">&#182;</a>               </div>               <h3>setPath</h3>

<p>Uses the sudo namespace's setpath function operating on the model's
data hash.</p>

<p><code>param</code> {String} <code>path</code>
<code>param</code> {*} <code>value</code>
<code>returns</code> {Object} this.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setPath</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">setPath</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">sudo</span><span class="p">.</span><span class="nx">setPath</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-41">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-41">&#182;</a>               </div>               <h3>sets</h3>

<p>Invokes <code>set()</code> or <code>setPath()</code> for each key value pair in <code>obj</code>.
Any listeners for those keys or paths will be called.</p>

<p><code>param</code> {Object} <code>obj</code>. The keys and values to set.
<code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">sets</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">sets</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">k</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">k</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">k</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">k</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">k</span><span class="p">[</span><span class="nx">i</span><span class="p">]])</span> <span class="o">:</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">setPath</span><span class="p">(</span><span class="nx">k</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">k</span><span class="p">[</span><span class="nx">i</span><span class="p">]]);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-42">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-42">&#182;</a>               </div>               <h3>unset</h3>

<p>Remove a key:value pair from this object's data store</p>

<p><code>param</code> {String} key
<code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">unset</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">unset</span><span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-43">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-43">&#182;</a>               </div>               <h3>unsetPath</h3>

<p>Uses <code>sudo.unsetPath</code> operating on this models data hash</p>

<p><code>param</code> {String} path
<code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">unsetPath</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">unsetPath</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">sudo</span><span class="p">.</span><span class="nx">unsetPath</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-44">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-44">&#182;</a>               </div>               <h3>unsets</h3>

<p>Deletes a number of keys or paths from this object's data store</p>

<p><code>param</code> {array} <code>ary</code>. An array of keys or paths.
<code>returns</code> {Objaect} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">unsets</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">unsets</span><span class="p">(</span><span class="nx">ary</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">i</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ary</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">ary</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">unset</span><span class="p">(</span><span class="nx">ary</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="o">:</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">unsetPath</span><span class="p">(</span><span class="nx">ary</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-45">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-45">&#182;</a>               </div>               <h2>Container Class Object</h2>

<p>A container is any object that can both contain other objects and
itself be contained</p>

<p><code>constructor</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Container</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">sudo</span><span class="p">.</span><span class="nx">Base</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">children</span> <span class="o">=</span> <span class="p">[];</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">childNames</span> <span class="o">=</span> <span class="p">{};</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-46">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-46">&#182;</a>               </div>               <p>Container is a subclass of sudo.Base</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">inherit</span><span class="p">(</span><span class="nx">sudo</span><span class="p">.</span><span class="nx">Base</span><span class="p">,</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">Container</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-47">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-47">&#182;</a>               </div>               <h3>addChild</h3>

<p>Adds a View to this container's list of children.
Also adds an 'index' property and an entry in the childNames hash.
If <code>addedToParent</code> if found on the child, call it, sending <code>this</code> as an argument.</p>

<p><code>param</code> {Object} <code>child</code>. View (or View subclass) instance.
<code>param</code> {String} <code>name</code>. An optional name for the child that will go in the childNames hash.
<code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Container</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">addChild</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">addChild</span><span class="p">(</span><span class="nx">child</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">children</span><span class="p">;</span>
  <span class="nx">child</span><span class="p">.</span><span class="nx">parent</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
  <span class="nx">child</span><span class="p">.</span><span class="nx">index</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">child</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">childNames</span><span class="p">[</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">child</span><span class="p">.</span><span class="nx">index</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nx">c</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">child</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="s1">&#39;addedToParent&#39;</span> <span class="k">in</span> <span class="nx">child</span><span class="p">)</span> <span class="nx">child</span><span class="p">.</span><span class="nx">addedToParent</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-48">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-48">&#182;</a>               </div>               <h3>bubble</h3>

<p>By default, <code>bubble</code> returns the current view's parent (if it has one)</p>

<p><code>returns</code> {Object|undefined}</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Container</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">bubble</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">bubble</span><span class="p">()</span> <span class="p">{</span><span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">;};</span></pre></div>             </td>           </tr>                               <tr id="section-49">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-49">&#182;</a>               </div>               <h3>getChild</h3>

<p>If a child was added with a name, via <code>addChild</code>,
that object can be fetched by name. This prevents us from having to reference a 
containers children by index. That is possible however, though not preferred.</p>

<p><code>param</code> {String|Number} <code>id</code>. The string <code>name</code> or numeric <code>index</code> of the child to fetch.
<code>returns</code> {Object|undefined} The found child</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Container</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getChild</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">getChild</span><span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">typeof</span> <span class="nx">id</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">childNames</span><span class="p">[</span><span class="nx">id</span><span class="p">]]</span> <span class="o">:</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="nx">id</span><span class="p">];</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-50">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-50">&#182;</a>               </div>               <h3><em>indexChildren</em></h3>

<p>Method is called with the <code>index</code> property of a subview that is being removed.
Beginning at <i> decrement subview indices.
<code>param</code> {Number} <code>i</code>
<code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Container</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_indexChildren_</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">_indexChildren_</span><span class="p">(</span><span class="nx">i</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">c</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">children</span><span class="p">,</span> <span class="nx">obj</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">childNames</span><span class="p">,</span> <span class="nx">len</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="nx">len</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">c</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">index</span><span class="o">--</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-51">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-51">&#182;</a>               </div>               <p>adjust any entries in childNames</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="nx">c</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">c</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">c</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">index</span><span class="p">;</span> 
  <span class="p">}</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-52">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-52">&#182;</a>               </div>               <h3>removeChild</h3>

<p>Find the intended child from my list of children and remove it, removing the name reference and re-indexing
remaining children. This method does not remove the child's DOM.
Override this method, doing whatever you want to the child's DOM, then call <code>base('removeChild')</code> to do so.</p>

<p><code>param</code> {String|Number|Object} <code>arg</code>. Children will always have an <code>index</code> number, and optionally a <code>name</code>.
If passed a string <code>name</code> is assumed, so be sure to pass an actual number if expecting to use index.
An object will be assumed to be an actual sudo Class Object.
<code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Container</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">removeChild</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">removeChild</span><span class="p">(</span><span class="nx">arg</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">t</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">arg</span><span class="p">,</span> <span class="nx">c</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-53">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-53">&#182;</a>               </div>               <p>normalize the input</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="nx">t</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">arg</span><span class="p">;</span> 
  <span class="k">else</span> <span class="nx">c</span> <span class="o">=</span> <span class="nx">t</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="k">this</span><span class="p">.</span><span class="nx">childNames</span><span class="p">[</span><span class="nx">arg</span><span class="p">]]</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">children</span><span class="p">[</span><span class="nx">arg</span><span class="p">];</span>
  <span class="nx">i</span> <span class="o">=</span> <span class="nx">c</span><span class="p">.</span><span class="nx">index</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-54">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-54">&#182;</a>               </div>               <p>remove from the children Array</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">children</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-55">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-55">&#182;</a>               </div>               <p>remove from the named child hash if present</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">childNames</span><span class="p">[</span><span class="nx">c</span><span class="p">.</span><span class="nx">name</span><span class="p">];</span></pre></div>             </td>           </tr>                               <tr id="section-56">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-56">&#182;</a>               </div>               <p>child is now an <code>orphan</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">delete</span> <span class="nx">c</span><span class="p">.</span><span class="nx">parent</span><span class="p">;</span>
  <span class="k">delete</span> <span class="nx">c</span><span class="p">.</span><span class="nx">index</span><span class="p">;</span>
  <span class="k">delete</span> <span class="nx">c</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">_indexChildren_</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-57">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-57">&#182;</a>               </div>               <h3>removeFromParent</h3>

<p>Remove this object from its parents list of children.
Does not alter the dom - do that yourself by overriding this method
or chaining method calls</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Container</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">removeFromParent</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">removeFromParent</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-58">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-58">&#182;</a>               </div>               <p>will error without a parent, but that would be your fault...</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">sudo</span><span class="p">.</span><span class="nx">Container</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">role</span> <span class="o">=</span> <span class="s1">&#39;container&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-59">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-59">&#182;</a>               </div>               <h3>send</h3>

<p>The call to the specific method on a (un)specified target happens here.
If this Object is part of a <code>sudo.Container</code> maintained hierarchy
the 'target' may be left out, causing the <code>bubble()</code> method to be called.
What this does is allow children of a <code>sudo.Container</code> to simply pass
events  upward, delegating the responsibility of deciding what to do to the parent.</p>

<p><code>param</code> {*} Any number of arguments is supported, but the first is the only one searched for info. 
A sendMethod will be located by:
  1. using the first argument if it is a string
  2. looking for a <code>sendMethod</code> property if it is an object
In the case a specified target exists at <code>this.model.get('sendTarget')</code> it will be used
Any other args will be passed to the sendMethod after <code>this</code>
<code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Container</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">send</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">send</span><span class="p">(</span><span class="cm">/*args*/</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">args</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">),</span>
    <span class="nx">d</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">meth</span><span class="p">,</span> <span class="nx">targ</span><span class="p">,</span> <span class="nx">fn</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-60">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-60">&#182;</a>               </div>               <p>normalize the input, common use cases first</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="nx">d</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;sendMethod&#39;</span> <span class="k">in</span> <span class="nx">d</span><span class="p">)</span> <span class="nx">meth</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">sendMethod</span><span class="p">;</span>
  <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="nx">meth</span> <span class="o">=</span> <span class="nx">args</span><span class="p">.</span><span class="nx">shift</span><span class="p">();</span></pre></div>             </td>           </tr>                               <tr id="section-61">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-61">&#182;</a>               </div>               <p>less common but viable options</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">meth</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-62">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-62">&#182;</a>               </div>               <p>passed as a jquery custom data attr bound in events</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">meth</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span> <span class="k">in</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">?</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">data</span><span class="p">.</span><span class="nx">sendMethod</span> <span class="o">:</span></pre></div>             </td>           </tr>                               <tr id="section-63">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-63">&#182;</a>               </div>               <p>passed in a hash from something or not passed at all</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">sendMethod</span> <span class="o">||</span> <span class="k">void</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-64">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-64">&#182;</a>               </div>               <p>target is either specified or my parent</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">targ</span> <span class="o">=</span> <span class="nx">d</span> <span class="o">&amp;&amp;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">sendTarget</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">bubble</span><span class="p">();</span></pre></div>             </td>           </tr>                               <tr id="section-65">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-65">&#182;</a>               </div>               <p>obvious chance for errors here, don't be dumb</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">fn</span> <span class="o">=</span> <span class="nx">targ</span><span class="p">[</span><span class="nx">meth</span><span class="p">];</span>
  <span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="nx">fn</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">targ</span> <span class="o">=</span> <span class="nx">targ</span><span class="p">.</span><span class="nx">bubble</span><span class="p">()))</span> <span class="p">{</span>
    <span class="nx">fn</span> <span class="o">=</span> <span class="nx">targ</span><span class="p">[</span><span class="nx">meth</span><span class="p">];</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-66">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-66">&#182;</a>               </div>               <p>sendMethods expect a signature (sender, ...)</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">args</span><span class="p">.</span><span class="nx">unshift</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="nx">fn</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="nx">targ</span><span class="p">,</span> <span class="nx">args</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-67">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-67">&#182;</a>               </div>               <h2>View Class Object</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-68">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-68">&#182;</a>               </div>               <p>Create an instance of a sudo.View object. A view is any object
that maintains its own <code>el</code>, that being some type of DOM element.
Pass in a string selector or an actual dom node reference to have the object
set that as its <code>el</code>. If no <code>el</code> is specified one will be created upon instantiation
based on the <code>tagName</code> (<code>div</code> by default). Specify <code>className</code>, <code>id</code> (or other attributes if desired)
as an (optional) <code>attributes</code> object literal on the <code>data</code> arg.</p>

<p>The view object uses <code>querySelector</code> for dom manipulation
and native event delegation etc...</p>

<p><code>param</code> {string|element} <code>el</code>. Otional el for the View instance.
<code>param</code> {Object} <code>data</code>. Optional data object-literal which becomes the initial state
of a new model located at <code>this.model</code>. Also can be a reference to an existing sudo.Model instance</p>

<p><code>constructor</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">View</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">sudo</span><span class="p">.</span><span class="nx">Container</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-69">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-69">&#182;</a>               </div>               <p>allow model instance to be passed in as well</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">model</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">role</span> <span class="o">===</span> <span class="s1">&#39;model&#39;</span> <span class="o">?</span> <span class="nx">data</span> <span class="o">:</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">model</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">Model</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="p">}</span> 
  <span class="k">this</span><span class="p">.</span><span class="nx">setEl</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">role</span> <span class="o">===</span> <span class="s1">&#39;view&#39;</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-70">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-70">&#182;</a>               </div>               <p>View inherits from Container
<code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">inherit</span><span class="p">(</span><span class="nx">sudo</span><span class="p">.</span><span class="nx">Container</span><span class="p">,</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">View</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-71">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-71">&#182;</a>               </div>               <h3>becomePremier</h3>

<p>Premier functionality provides hooks for behavioral differentiation
among elements or class objects.</p>

<p><code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">becomePremier</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">becomePremier</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">p</span><span class="p">,</span> <span class="nx">f</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">isPremier</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
      <span class="nx">sudo</span><span class="p">.</span><span class="nx">premier</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-72">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-72">&#182;</a>               </div>               <p>is there an existing premier that isn't me?</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">((</span><span class="nx">p</span> <span class="o">=</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">premier</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">p</span><span class="p">.</span><span class="nx">uid</span> <span class="o">!==</span> <span class="k">this</span><span class="p">.</span><span class="nx">uid</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-73">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-73">&#182;</a>               </div>               <p>ask it to resign and call the cb</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">p</span><span class="p">.</span><span class="nx">resignPremier</span><span class="p">(</span><span class="nx">f</span><span class="p">);</span>
  <span class="p">}</span> <span class="k">else</span> <span class="nx">f</span><span class="p">();</span> <span class="c1">// no existing premier</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-74">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-74">&#182;</a>               </div>               <h3>init</h3>

<p>A 'contruction-time' hook to call for further initialization needs in 
View objects (and their subclasses). A noop by default child classes should override.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">init</span> <span class="o">=</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">noop</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-75">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-75">&#182;</a>               </div>               <h3><em>normalizedEl</em></h3>

<p>Pass a string selector through querySelector, returning the result or
simply return a passed in DOM element</p>

<p><code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_normalizedEl_</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">_normalizedEl_</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">typeof</span> <span class="nx">el</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span> <span class="o">?</span> <span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="o">:</span> <span class="nx">el</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-76">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-76">&#182;</a>               </div>               <h3>resignPremier</h3>

<p>Resign premier status</p>

<p><code>param</code> {Function} <code>cb</code>. An optional callback to execute
after resigning premier status.
<code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">resignPremier</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">resignPremier</span><span class="p">(</span><span class="nx">cb</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">p</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">isPremier</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-77">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-77">&#182;</a>               </div>               <p>only remove the global premier if it is me</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">((</span><span class="nx">p</span> <span class="o">=</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">premier</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="nx">p</span><span class="p">.</span><span class="nx">uid</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">uid</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">sudo</span><span class="p">.</span><span class="nx">premier</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-78">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-78">&#182;</a>               </div>               <p>fire the cb if passed</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="nx">cb</span><span class="p">)</span> <span class="nx">cb</span><span class="p">();</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-79">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-79">&#182;</a>               </div>               <p><code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">role</span> <span class="o">=</span> <span class="s1">&#39;view&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-80">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-80">&#182;</a>               </div>               <h3>setEl</h3>

<p>A view must have an element, set that here.
Stores a DOM object as <code>this.el</code></p>

<p><code>param</code> {string=|element} <code>el</code>
<code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setEl</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">setEl</span><span class="p">(</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">a</span><span class="p">,</span> <span class="nx">k</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">t</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">el</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-81">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-81">&#182;</a>               </div>               <p>normalize any relevant data</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">t</span> <span class="o">=</span> <span class="nx">d</span> <span class="o">?</span> <span class="nx">d</span><span class="p">.</span><span class="nx">tagName</span> <span class="o">||</span> <span class="s1">&#39;div&#39;</span><span class="o">:</span> <span class="s1">&#39;div&#39;</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">el</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">t</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-82">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-82">&#182;</a>               </div>               <p>TODO this</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="nx">d</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">a</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">attributes</span><span class="p">))</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-83">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-83">&#182;</a>               </div>               <p>iterate and set the attributes</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">k</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">a</span><span class="p">);</span>
      <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">k</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">k</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">a</span><span class="p">[</span><span class="nx">k</span><span class="p">[</span><span class="nx">i</span><span class="p">]]);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">el</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_normalizedEl_</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-84">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-84">&#182;</a>               </div>               <h3>this.$</h3>

<p>Return a single Element matching <code>sel</code> scoped to this View's el.
This is an alias to <code>this.el.querySelector(sel)</code>.</p>

<p><code>param</code> {string} <code>sel</code>. A querySelector compatible selector
<code>returns</code> {Element | undefined} A result matching the selector (or undefined if not)</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">$</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sel</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="nx">sel</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-85">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-85">&#182;</a>               </div>               <h3>this.$$</h3>

<p>Return multiple Elements (a NodeList) matching <code>sel</code> scoped to this View's el.
This is an alias to <code>this.el.querySelectorAll(sel)</code>.</p>

<p><code>param</code> {string} <code>sel</code>. A querySelectorAll compatible selector
<code>returns</code> {Elements | undefined} Results matching the selector (or undefined if not)</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">$$</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">sel</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="nx">sel</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-86">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-86">&#182;</a>               </div>               <h2>ViewController Class Object</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-87">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-87">&#182;</a>               </div>               <p>ViewControllers were designed for Rails projects for 2 specific use-cases:</p>

<ol>
<li>ViewControllers can instantiate any <code>descriptors</code> found in their model
when constructing, adding them as <code>child</code> objects. Why? Sometimes a 'partial' will
need to define a javascript object that should, by design, be the child of a parent View
that is itself defined on the Rails view that owns the 'partial'. Since any JS introduced
by a partial will be parsed before the JS on its parent Rails View this usually isn't possible.
Our solution? Pushing <code>Descriptor objects</code> (see docs) into an array (somewhere in your namespace) from a 
'partial' and then passing a reference to that array into the ViewController as 'descriptors'
in its optional data argument when instantiated. The ViewController will then iterate over those 
and instantiate them, adding them as children as it goes (also setting up any stated observers)</li>
</ol>

<p><code>param</code> {string|element} <code>el</code>. Otional el for the View instance.
<code>param</code> {object} <code>data</code>. Optional data object.</p>

<p><code>see</code> sudo.View.</p>

<p><code>constructor</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">ViewController</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">sudo</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">el</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="s1">&#39;descriptor&#39;</span> <span class="k">in</span> <span class="nx">data</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">instantiateChildren</span><span class="p">([</span><span class="nx">data</span><span class="p">.</span><span class="nx">descriptor</span><span class="p">]);</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="s1">&#39;descriptors&#39;</span> <span class="k">in</span> <span class="nx">data</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">instantiateChildren</span><span class="p">();</span>
  <span class="p">}</span>
  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">role</span> <span class="o">===</span> <span class="s1">&#39;viewController&#39;</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-88">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-88">&#182;</a>               </div>               <p>ViewController inherits from View.
<code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">inherit</span><span class="p">(</span><span class="nx">sudo</span><span class="p">.</span><span class="nx">View</span><span class="p">,</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">ViewController</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-89">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-89">&#182;</a>               </div>               <h3><em>handleObserve</em></h3>

<p>Helper for instantiateChildren
<code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">ViewController</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_handleObserve_</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">_handleObserve_</span><span class="p">(</span><span class="nx">obs</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="nx">obs</span><span class="p">.</span><span class="nx">object</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">_objectForPath_</span><span class="p">(</span><span class="nx">obs</span><span class="p">.</span><span class="nx">object</span><span class="p">)</span> <span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">;</span>
  <span class="nx">obj</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">c</span><span class="p">[</span><span class="nx">obs</span><span class="p">.</span><span class="nx">cb</span><span class="p">].</span><span class="nx">bind</span><span class="p">(</span><span class="nx">c</span><span class="p">));</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-90">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-90">&#182;</a>               </div>               <h3>instantiateChildren</h3>

<p>instantiate the children described in the passed in array or the <code>descriptors</code> array
set in this object's data store</p>

<p><code>returns</code> {object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">ViewController</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">instantiateChildren</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">instantiateChildren</span><span class="p">(</span><span class="nx">ary</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span><span class="p">,</span> <span class="nx">curr</span><span class="p">,</span> <span class="nx">c</span><span class="p">,</span> <span class="nx">d</span> <span class="o">=</span> <span class="nx">ary</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">descriptors</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">curr</span> <span class="o">=</span> <span class="nx">d</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span> 
    <span class="nx">c</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">curr</span><span class="p">.</span><span class="nx">is_a</span><span class="p">(</span><span class="nx">curr</span><span class="p">.</span><span class="nx">el</span><span class="p">,</span> <span class="nx">curr</span><span class="p">.</span><span class="nx">data</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">addChild</span><span class="p">(</span><span class="nx">c</span><span class="p">,</span> <span class="nx">curr</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-91">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-91">&#182;</a>               </div>               <p>handle any observe(s)</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="s1">&#39;observe&#39;</span> <span class="k">in</span> <span class="nx">curr</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_handleObserve_</span><span class="p">(</span><span class="nx">curr</span><span class="p">.</span><span class="nx">observe</span><span class="p">,</span> <span class="nx">c</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="s1">&#39;observes&#39;</span> <span class="k">in</span> <span class="nx">curr</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">for</span><span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;</span> <span class="nx">curr</span><span class="p">.</span><span class="nx">observes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_handleObserve_</span><span class="p">(</span><span class="nx">curr</span><span class="p">.</span><span class="nx">observes</span><span class="p">[</span><span class="nx">j</span><span class="p">],</span> <span class="nx">c</span><span class="p">);</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-92">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-92">&#182;</a>               </div>               <h3><em>objectForPath</em></h3>

<p>The objects used for callbacks and connections need to be
looked-up via a key-path like address as they likely will not exist
when viewController's are instantiated.
<code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">ViewController</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_objectForPath_</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">_objectForPath_</span><span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">getPath</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nb">window</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-93">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-93">&#182;</a>               </div>               <p><code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">ViewController</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">role</span> <span class="o">=</span> <span class="s1">&#39;viewController&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-94">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-94">&#182;</a>               </div>               <h2>DataView Class Object</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-95">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-95">&#182;</a>               </div>               <p>Create an instance of an Object, inheriting from sudo.View that:
1. Expects to have a template located in its internal data Store accessible via <code>this.get('template')</code>.
2. Can have a <code>renderTarget</code> property in its data store. If so this will be the location
    the child injects itself into (if not already in) the DOM
3. Can have a 'renderMethod' property in its data store. If so this is the jQuery method
    that the child will use to place itself in it's <code>renderTarget</code>.
4. Has a <code>render</code> method that when called re-hydrates it's el by passing its
    internal data store to its template
5. Handles event binding/unbinding by implementing the sudo.extensions.listener
    extension object</p>

<p><code>constructor</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">DataView</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="nx">data</span> <span class="o">||</span> <span class="p">{},</span> <span class="nx">t</span><span class="p">;</span>
  <span class="nx">sudo</span><span class="p">.</span><span class="nx">View</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">el</span><span class="p">,</span> <span class="nx">d</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-96">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-96">&#182;</a>               </div>               <p>implements the listener extension</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">extensions</span><span class="p">.</span><span class="nx">listener</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-97">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-97">&#182;</a>               </div>               <p>dataview's models are observable</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">_</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">,</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">extensions</span><span class="p">.</span><span class="nx">observable</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-98">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-98">&#182;</a>               </div>               <p>dont autoRender on the setting of events,
add to this to prevent others if needed</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">autoRenderBlacklist</span> <span class="o">=</span> <span class="p">{</span><span class="nx">event</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">events</span><span class="o">:</span> <span class="kc">true</span><span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-99">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-99">&#182;</a>               </div>               <p>if autorendering, observe your own model
use this ref to unobserve if desired</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">autoRender</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">observer</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-100">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-100">&#182;</a>               </div>               <p>compile my template if not already done</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">((</span><span class="nx">t</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">template</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">t</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">template</span> <span class="o">=</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="nx">t</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">bindEvents</span><span class="p">();</span>
  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">role</span> <span class="o">===</span> <span class="s1">&#39;dataview&#39;</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">init</span><span class="p">();</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-101">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-101">&#182;</a>               </div>               <p><code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">inherit</span><span class="p">(</span><span class="nx">sudo</span><span class="p">.</span><span class="nx">View</span><span class="p">,</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">DataView</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-102">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-102">&#182;</a>               </div>               <h3>addedToParent</h3>

<p>Container's will check for the presence of this method and call it if it is present
after adding a child - essentially, this will auto render the dataview when added to a parent</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">DataView</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">addedToParent</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">render</span><span class="p">();</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-103">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-103">&#182;</a>               </div>               <h3>removeFromParent</h3>

<p>Remove this object from the DOM and its parent's list of children.
Overrides <code>sudo.View.removeFromParent</code> to actually remove the DOM as well</p>

<p><code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">DataView</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">removeFromParent</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">removeFromParent</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">parent</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-104">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-104">&#182;</a>               </div>               <h3>render</h3>

<p>(Re)hydrate the innerHTML of this object via its template and internal data store.
If a <code>renderTarget</code> is present this Object will inject itself into the target via
<code>this.get('renderMethod')</code> or defualt to <code>appendChild</code>. After injection, the <code>renderTarget</code>
is deleted from this Objects data store.
Event unbinding/rebinding is generally not necessary for the Objects innerHTML as all events from the
Object's list of events (<code>this.get('event(s)'))</code> are delegated to the el on instantiation.</p>

<p><code>param</code> {object} <code>change</code> dataviews may be observing their model if <code>autoRender: true</code></p>

<p><code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">DataView</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">render</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">render</span><span class="p">(</span><span class="nx">change</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">d</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-105">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-105">&#182;</a>               </div>               <p>return early if a <code>blacklisted</code> key is set to my model</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="nx">change</span> <span class="o">&amp;&amp;</span> <span class="k">this</span><span class="p">.</span><span class="nx">autoRenderBlacklist</span><span class="p">[</span><span class="nx">change</span><span class="p">.</span><span class="nx">name</span><span class="p">])</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="nx">d</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-106">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-106">&#182;</a>               </div>               <p>TODO research innerDOM</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">template</span><span class="p">(</span><span class="nx">d</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">renderTarget</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">_normalizedEl_</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">renderTarget</span><span class="p">)[</span><span class="nx">d</span><span class="p">.</span><span class="nx">renderMethod</span> <span class="o">||</span> <span class="s1">&#39;appendChild&#39;</span><span class="p">](</span><span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">);</span>
    <span class="k">delete</span> <span class="nx">d</span><span class="p">.</span><span class="nx">renderTarget</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-107">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-107">&#182;</a>               </div>               <p><code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">DataView</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">role</span> <span class="o">=</span> <span class="s1">&#39;dataview&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-108">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-108">&#182;</a>               </div>               <h3>Templating</h3>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-109">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-109">&#182;</a>               </div>               <p>Allow the default {{ js code }}, {{= key }}, and {{- escape stuff }} 
micro templating delimiters to be overridden if desired</p>

<p><code>type</code> {Object}</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">templateSettings</span> <span class="o">=</span> <span class="p">{</span>
  <span class="nx">evaluate</span><span class="o">:</span> <span class="sr">/\{\{([\s\S]+?)\}\}/g</span><span class="p">,</span>
  <span class="nx">interpolate</span><span class="o">:</span> <span class="sr">/\{\{=([\s\S]+?)\}\}/g</span><span class="p">,</span>
  <span class="nx">escape</span><span class="o">:</span> <span class="sr">/\{\{-([\s\S]+?)\}\}/g</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-110">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-110">&#182;</a>               </div>               <p>Certain characters need to be escaped so that they can be put 
into a string literal when templating.</p>

<p><code>type</code> {Object}</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">escapes</span> <span class="o">=</span> <span class="p">{};</span>
<span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">e</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;\\&#39;</span><span class="o">:</span> <span class="s1">&#39;\\&#39;</span><span class="p">,</span>
    <span class="s2">&quot;&#39;&quot;</span><span class="o">:</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span>
    <span class="nx">r</span><span class="o">:</span> <span class="s1">&#39;\r&#39;</span><span class="p">,</span>
    <span class="nx">n</span><span class="o">:</span> <span class="s1">&#39;\n&#39;</span><span class="p">,</span>
    <span class="nx">t</span><span class="o">:</span> <span class="s1">&#39;\t&#39;</span><span class="p">,</span>
    <span class="nx">u2028</span><span class="o">:</span> <span class="s1">&#39;\u2028&#39;</span><span class="p">,</span>
    <span class="nx">u2029</span><span class="o">:</span> <span class="s1">&#39;\u2029&#39;</span>
  <span class="p">};</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">key</span> <span class="k">in</span> <span class="nx">e</span><span class="p">)</span> <span class="nx">s</span><span class="p">.</span><span class="nx">escapes</span><span class="p">[</span><span class="nx">e</span><span class="p">[</span><span class="nx">key</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">key</span><span class="p">;</span>
<span class="p">}(</span><span class="nx">sudo</span><span class="p">));</span></pre></div>             </td>           </tr>                               <tr id="section-111">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-111">&#182;</a>               </div>               <p>lookup hash for <code>escape</code></p>

<p><code>type</code> {Object}</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">htmlEscapes</span> <span class="o">=</span> <span class="p">{</span>
  <span class="s1">&#39;&amp;&#39;</span><span class="o">:</span> <span class="s1">&#39;&amp;amp;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;&lt;&#39;</span><span class="o">:</span> <span class="s1">&#39;&amp;lt;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;&gt;&#39;</span><span class="o">:</span> <span class="s1">&#39;&amp;gt;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;&quot;&#39;</span><span class="o">:</span> <span class="s1">&#39;&amp;quot;&#39;</span><span class="p">,</span>
  <span class="s2">&quot;&#39;&quot;</span><span class="o">:</span> <span class="s1">&#39;&amp;#x27;&#39;</span><span class="p">,</span>
  <span class="s1">&#39;/&#39;</span><span class="o">:</span> <span class="s1">&#39;&amp;#x2F;&#39;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-112">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-112">&#182;</a>               </div>               <p>Escapes certain characters for templating</p>

<p><code>type</code> {regexp}</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">escaper</span> <span class="o">=</span> <span class="sr">/\\|&#39;|\r|\n|\t|\u2028|\u2029/g</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-113">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-113">&#182;</a>               </div>               <p>Escape unsafe HTML</p>

<p><code>type</code> {regexp}</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">htmlEscaper</span> <span class="o">=</span> <span class="sr">/[&amp;&lt;&gt;&quot;&#39;\/]/g</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-114">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-114">&#182;</a>               </div>               <p>Unescapes certain characters for templating</p>

<p><code>type</code> {regexp}</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">unescaper</span> <span class="o">=</span> <span class="sr">/\\(\\|&#39;|r|n|t|u2028|u2029)/g</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-115">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-115">&#182;</a>               </div>               <h3>escape</h3>

<p>Remove unsafe characters from a string</p>

<p><code>param</code> {String} str</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">escape</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">sudo</span><span class="p">.</span><span class="nx">htmlEscaper</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">htmlEscapes</span><span class="p">[</span><span class="nx">match</span><span class="p">];</span>
  <span class="p">});</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-116">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-116">&#182;</a>               </div>               <h3>unescape</h3>

<p>Within an interpolation, evaluation, or escaping,
remove HTML escaping that had been previously added.</p>

<p><code>param</code> {string} str</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">unescape</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">unescape</span><span class="p">(</span><span class="nx">str</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">sudo</span><span class="p">.</span><span class="nx">unescaper</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">,</span> <span class="nx">escape</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">escapes</span><span class="p">[</span><span class="nx">escape</span><span class="p">];</span>
  <span class="p">});</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-117">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-117">&#182;</a>               </div>               <h3>template</h3>

<p>JavaScript micro-templating, similar to John Resig's (and it's offspring) implementation.
sudo templating preserves whitespace, and correctly escapes quotes within interpolated code.
Unlike others sudo.template requires a scope name (to avoid the use of <code>with</code>) and will spit at you
if it is not present.</p>

<p><code>param</code> {string} <code>str</code>. The 'templated' string.
<code>param</code> {Object} <code>data</code>. Optional hash of key:value pairs.
<code>param</code> {string} <code>scope</code>. Optional context name of your <code>data object</code>, set to 'data' if falsy.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">template</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">template</span><span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">scope</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">scope</span> <span class="o">||</span> <span class="p">(</span><span class="nx">scope</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">settings</span> <span class="o">=</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">templateSettings</span><span class="p">,</span> <span class="nx">render</span><span class="p">,</span> <span class="nx">template</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-118">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-118">&#182;</a>               </div>               <p>Compile the template source, taking care to escape characters that
cannot be included in a string literal and then unescape them in code blocks.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">source</span> <span class="o">=</span> <span class="s2">&quot;_p+=&#39;&quot;</span> <span class="o">+</span> <span class="nx">str</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">sudo</span><span class="p">.</span><span class="nx">escaper</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s1">&#39;\\&#39;</span> <span class="o">+</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">escapes</span><span class="p">[</span><span class="nx">match</span><span class="p">];</span>
  <span class="p">}).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">escape</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">&quot;&#39;+\n((_t=(&quot;</span> <span class="o">+</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">unescape</span><span class="p">(</span><span class="nx">code</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;))==null?&#39;&#39;:sudo.escape(_t))+\n&#39;&quot;</span><span class="p">;</span>
  <span class="p">}).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">interpolate</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">&quot;&#39;+\n((_t=(&quot;</span> <span class="o">+</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">unescape</span><span class="p">(</span><span class="nx">code</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;))==null?&#39;&#39;:_t)+\n&#39;&quot;</span><span class="p">;</span>
  <span class="p">}).</span><span class="nx">replace</span><span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">evaluate</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">match</span><span class="p">,</span> <span class="nx">code</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">&quot;&#39;;\n&quot;</span> <span class="o">+</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">unescape</span><span class="p">(</span><span class="nx">code</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;\n_p+=&#39;&quot;</span><span class="p">;</span>
  <span class="p">})</span> <span class="o">+</span> <span class="s2">&quot;&#39;;\n&quot;</span><span class="p">;</span>
  <span class="nx">source</span> <span class="o">=</span> <span class="s2">&quot;var _t,_p=&#39;&#39;;&quot;</span> <span class="o">+</span> <span class="nx">source</span> <span class="o">+</span> <span class="s2">&quot;return _p;\n&quot;</span><span class="p">;</span>
  <span class="nx">render</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Function</span><span class="p">(</span><span class="nx">scope</span><span class="p">,</span> <span class="nx">source</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="k">return</span> <span class="nx">render</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
  <span class="nx">template</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">render</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
  <span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-119">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-119">&#182;</a>               </div>               <p>Provide the compiled function source as a convenience for reflection/compilation</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">template</span><span class="p">.</span><span class="nx">source</span> <span class="o">=</span> <span class="s1">&#39;function(&#39;</span> <span class="o">+</span> <span class="nx">scope</span> <span class="o">+</span> <span class="s1">&#39;){\n&#39;</span> <span class="o">+</span> <span class="nx">source</span> <span class="o">+</span> <span class="s1">&#39;}&#39;</span><span class="p">;</span>
  <span class="k">return</span> <span class="nx">template</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-120">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-120">&#182;</a>               </div>               <h2>Navigator Class Object</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-121">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-121">&#182;</a>               </div>               <p>Abstracts location and history events, parsing their information into a 
normalized object that is then set to an Observable class instance</p>

<p><code>constructor</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Navigator</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">started</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">slashStripper</span> <span class="o">=</span> <span class="sr">/^\/+|\/+$/g</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">leadingStripper</span> <span class="o">=</span> <span class="sr">/^[#\/]|\s+$/g</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">trailingStripper</span> <span class="o">=</span> <span class="sr">/\/$/</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">construct</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-122">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-122">&#182;</a>               </div>               <p>Navigator inherits from <code>sudo.Model</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Navigator</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">sudo</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-123">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-123">&#182;</a>               </div>               <h3>getFragment</h3>

<p>'Fragment' is defined as any URL information after the 'root' path
including the <code>search</code> or <code>hash</code></p>

<p><code>returns</code> {String} <code>fragment</code>
<code>returns</code> {String} the normalized current fragment</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Navigator</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getFragment</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">getFragment</span><span class="p">(</span><span class="nx">fragment</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">root</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">root</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">fragment</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-124">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-124">&#182;</a>               </div>               <p>intentional use of coersion</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isPushState</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">fragment</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">pathname</span><span class="p">;</span>
      <span class="nx">root</span> <span class="o">=</span> <span class="nx">root</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">trailingStripper</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">fragment</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">root</span><span class="p">))</span> <span class="nx">fragment</span> <span class="o">=</span> <span class="nx">fragment</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="nx">root</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
      <span class="nx">fragment</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getHash</span><span class="p">();</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nb">decodeURIComponent</span><span class="p">(</span><span class="nx">fragment</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">leadingStripper</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">));</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-125">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-125">&#182;</a>               </div>               <h3>getHash</h3>

<p>Check either the passed in fragment, or the full location.href
for a <code>hash</code> value</p>

<p><code>param</code> {string} <code>fragment</code> Optional fragment to check
<code>returns</code> {String} the normalized current <code>hash</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Navigator</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getHash</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">getHash</span><span class="p">(</span><span class="nx">fragment</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">fragment</span> <span class="o">||</span> <span class="p">(</span><span class="nx">fragment</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">match</span> <span class="o">=</span> <span class="nx">fragment</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/#(.*)$/</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">match</span> <span class="o">?</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-126">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-126">&#182;</a>               </div>               <h3>getSearch</h3>

<p>Check either the passed in fragment, or the full location.href
for a <code>search</code> value</p>

<p><code>param</code> {string} <code>fragment</code> Optional fragment to check
<code>returns</code> {String} the normalized current <code>search</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Navigator</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getSearch</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">getSearch</span><span class="p">(</span><span class="nx">fragment</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">fragment</span> <span class="o">||</span> <span class="p">(</span><span class="nx">fragment</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="p">);</span>
  <span class="kd">var</span> <span class="nx">match</span> <span class="o">=</span> <span class="nx">fragment</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/\?(.*)$/</span><span class="p">);</span>
  <span class="k">return</span> <span class="nx">match</span> <span class="o">?</span> <span class="nx">match</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-127">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-127">&#182;</a>               </div>               <h3>getUrl</h3>

<p>fetch the URL in the form <root + fragment></p>

<p><code>returns</code> {String}</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Navigator</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">getUrl</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">getUrl</span><span class="p">()</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-128">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-128">&#182;</a>               </div>               <p>note that delegate(<em>role</em>) returns the deleagte</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">root</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">fragment</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-129">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-129">&#182;</a>               </div>               <h3>go</h3>

<p>If the passed in 'fragment' is different than the currently stored one,
push a new state entry / hash event and set the data where specified</p>

<p><code>param</code> {string} <code>fragment</code>
<code>returns</code> {*} call to <code>setData</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Navigator</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">go</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">go</span><span class="p">(</span><span class="nx">fragment</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">started</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">urlChanged</span><span class="p">(</span><span class="nx">fragment</span><span class="p">))</span> <span class="k">return</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-130">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-130">&#182;</a>               </div>               <p>TODO ever use replaceState?</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isPushState</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">({},</span> <span class="nb">document</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">getUrl</span><span class="p">());</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isHashChange</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">hash</span> <span class="o">=</span> <span class="s1">&#39;#&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">fragment</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">();</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-131">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-131">&#182;</a>               </div>               <h3>handleChange</h3>

<p>Bound to either the <code>popstate</code> or <code>hashchange</code> events, if the
URL has indeed changed then parse the relevant data and set it -
triggering change observers</p>

<p><code>returns</code> {*} call to <code>setData</code> or undefined</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Navigator</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">handleChange</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">handleChange</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">urlChanged</span><span class="p">())</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">setData</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-132">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-132">&#182;</a>               </div>               <h3>parseQuery</h3>

<p>Parse and return a hash of the key value pairs contained in 
the current <code>query</code></p>

<p><code>returns</code> {object}</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Navigator</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">parseQuery</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">parseQuery</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{},</span> <span class="nx">seg</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">query</span><span class="p">,</span>
    <span class="nx">i</span><span class="p">,</span> <span class="nx">s</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">seg</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">seg</span> <span class="o">=</span> <span class="nx">seg</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;&amp;&#39;</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">seg</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">seg</span><span class="p">[</span><span class="nx">i</span><span class="p">])</span> <span class="k">continue</span><span class="p">;</span>
      <span class="nx">s</span> <span class="o">=</span> <span class="nx">seg</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">);</span>
      <span class="nx">obj</span><span class="p">[</span><span class="nx">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="nx">s</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">obj</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-133">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-133">&#182;</a>               </div>               <h3>setData</h3>

<p>Using the current <code>fragment</code> (minus any search or hash data) as a key,
use <code>parseQuery</code> as the value for the key, setting it into the specified
model (a stated <code>Observable</code> or <code>this.data</code>)</p>

<p><code>returns</code> {object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Navigator</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">setData</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">setData</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">frag</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">fragment</span><span class="p">,</span></pre></div>             </td>           </tr>                               <tr id="section-134">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-134">&#182;</a>               </div>               <p>data is set in a specified model or in self</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">observable</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">observable</span> <span class="o">||</span> <span class="k">this</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">query</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-135">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-135">&#182;</a>               </div>               <p>we want to set the key minus any search/hash</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">frag</span> <span class="o">=</span> <span class="nx">frag</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span> <span class="o">?</span> <span class="nx">frag</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">:</span> <span class="nx">frag</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
  <span class="p">}</span>
  <span class="nx">observable</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">frag</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">parseQuery</span><span class="p">());</span>
  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-136">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-136">&#182;</a>               </div>               <h3>start</h3>

<p>Gather the necessary information about the current environment and 
bind to either (push|pop)state or hashchange.
Also, if given an imcorrect URL for the current environment (hashchange 
vs pushState) normalize it and set accordingly.</p>

<p><code>returns</code> {object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Navigator</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">start</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">start</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">hasPushState</span><span class="p">,</span> <span class="nx">atRoot</span><span class="p">,</span> <span class="nx">loc</span><span class="p">,</span> <span class="nx">tmp</span><span class="p">;</span>
  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">started</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>
  <span class="nx">hasPushState</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">history</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">started</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-137">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-137">&#182;</a>               </div>               <p>setup the initial configuration</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">isHashChange</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">useHashChange</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;onhashchange&#39;</span> <span class="k">in</span> <span class="nb">window</span> <span class="o">||</span> 
    <span class="p">(</span><span class="o">!</span><span class="nx">hasPushState</span> <span class="o">&amp;&amp;</span> <span class="s1">&#39;onhashchange&#39;</span> <span class="k">in</span> <span class="nb">window</span><span class="p">);</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">isPushState</span> <span class="o">=</span> <span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">isHashChange</span> <span class="o">&amp;&amp;</span> <span class="o">!!</span><span class="nx">hasPushState</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-138">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-138">&#182;</a>               </div>               <p>normalize the root to always contain a leading and trailing slash</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="s1">&#39;root&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="s1">&#39;root&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">slashStripper</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-139">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-139">&#182;</a>               </div>               <p>Get a snapshot of the current fragment</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">this</span><span class="p">.</span><span class="nx">urlChanged</span><span class="p">();</span></pre></div>             </td>           </tr>                               <tr id="section-140">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-140">&#182;</a>               </div>               <p>monitor URL changes via popState or hashchange</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isPushState</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;popstate&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isHashChange</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;hashchange&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">));</span>
  <span class="p">}</span> <span class="k">else</span> <span class="k">return</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-141">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-141">&#182;</a>               </div>               <p>Does the current URL need to changed? (hashchange vs popstate)</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">atRoot</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">pathname</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[^\/]$/</span><span class="p">,</span> <span class="s1">&#39;$&amp;/&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="s1">&#39;root&#39;</span><span class="p">];</span></pre></div>             </td>           </tr>                               <tr id="section-142">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-142">&#182;</a>               </div>               <p>somehow a pushstate URL got here (and here is hashchange)</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isHashChange</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nx">atRoot</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="s1">&#39;root&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span> <span class="o">+</span> <span class="s1">&#39;#&#39;</span> <span class="o">+</span> 
      <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">fragment</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-143">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-143">&#182;</a>               </div>               <p>return early as browser will redirect</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="kc">true</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-144">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-144">&#182;</a>               </div>               <p>the converse of the above</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="p">}</span> <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">isPushState</span> <span class="o">&amp;&amp;</span> <span class="nx">atRoot</span> <span class="o">&amp;&amp;</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">hash</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">tmp</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getHash</span><span class="p">().</span><span class="nx">replace</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">leadingStripper</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
    <span class="nb">window</span><span class="p">.</span><span class="nx">history</span><span class="p">.</span><span class="nx">replaceState</span><span class="p">({},</span> <span class="nb">document</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="s1">&#39;root&#39;</span><span class="p">]</span> <span class="o">+</span> 
      <span class="nx">tmp</span> <span class="o">+</span> <span class="nb">window</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span><span class="p">);</span>
  <span class="p">}</span></pre></div>             </td>           </tr>                               <tr id="section-145">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-145">&#182;</a>               </div>               <p>TODO provide option to <code>go</code> from inital <code>start</code> state?</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-146">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-146">&#182;</a>               </div>               <p>Is a passed in fragment different from the currently set one?</p>

<p><code>param</code> {String} <code>fragment</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">Navigator</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">urlChanged</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">urlChanged</span><span class="p">(</span><span class="nx">fragment</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">current</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getFragment</span><span class="p">(</span><span class="nx">fragment</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-147">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-147">&#182;</a>               </div>               <p>nothing has changed</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span> <span class="p">(</span><span class="nx">current</span> <span class="o">===</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">fragment</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">fragment</span> <span class="o">=</span> <span class="nx">current</span><span class="p">;</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">query</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">getSearch</span><span class="p">(</span><span class="nx">current</span><span class="p">)</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">getHash</span><span class="p">(</span><span class="nx">current</span><span class="p">);</span>
  <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-148">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-148">&#182;</a>               </div>               <h2>Observable Extension Object</h2>

<p>Implementaion of the ES6 Harmony Observer pattern.
Extend a <code>sudo.Model</code> class with this object if
data-mutation-observation is required</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">extensions</span><span class="p">.</span><span class="nx">observable</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-149">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-149">&#182;</a>               </div>               <h3><em>deliver</em></h3>

<p>Called from deliverChangeRecords when ready to send
changeRecords to observers.</p>

<p><code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">_deliver_</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">_deliver_</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">cb</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">callbacks</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">cb</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">cb</span><span class="p">[</span><span class="nx">i</span><span class="p">](</span><span class="nx">obj</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-150">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-150">&#182;</a>               </div>               <h3>deliverChangeRecords</h3>

<p>Iterate through the changeRecords array(emptying it as you go), delivering them to the
observers. You can override this method to change the standard delivery behavior.</p>

<p><code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">deliverChangeRecords</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">deliverChangeRecords</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">rec</span><span class="p">,</span> <span class="nx">cr</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">changeRecords</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-151">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-151">&#182;</a>               </div>               <p>FIFO</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">for</span><span class="p">(</span><span class="nx">rec</span><span class="p">;</span> <span class="nx">cr</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">rec</span> <span class="o">=</span> <span class="nx">cr</span><span class="p">.</span><span class="nx">shift</span><span class="p">());)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_deliver_</span><span class="p">(</span><span class="nx">rec</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-152">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-152">&#182;</a>               </div>               <h3>observe</h3>

<p>In a quasi-ES6 Object.observe pattern, calling observe on an <code>observable</code> and 
passing a callback will cause that callback to be called whenever any
property on the observable's data store is set, changed or deleted 
via set, unset, setPath or unsetPath with an object containing:
    {
     type: <new, updated, deleted>,
     object: <the object being observed>,
     name: <the key that was modified>,
     oldValue: <if a previous value existed for this key>
    }
For ease of 'unobserving' the same Function passed in is returned.</p>

<p><code>param</code> {Function} <code>fn</code> The callback to be called with changeRecord(s)
<code>returns</code> {Function} the Function passed in as an argument</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">observe</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">observe</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-153">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-153">&#182;</a>               </div>               <p>this will fail if mixed-in and no <code>callbacks</code> created so don't do that.
Per the spec, do not allow the same callback to be added</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="kd">var</span> <span class="nx">d</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">callbacks</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="nx">d</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">fn</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">fn</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-154">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-154">&#182;</a>               </div>               <h3>observes</h3>

<p>Allow an array of callbacks to be registered as changeRecord recipients</p>

<p><code>param</code> {Array} ary
<code>returns</code> {Array} the Array passed in to observe</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">observes</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">observes</span><span class="p">(</span><span class="nx">ary</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ary</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">observe</span><span class="p">(</span><span class="nx">ary</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">ary</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-155">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-155">&#182;</a>               </div>               <h3>set</h3>

<p>Overrides sudo.Base.set to check for observers</p>

<p><code>param</code> {String} <code>key</code>. The name of the key
<code>param</code> {*} <code>value</code>
<code>param</code> {Bool} <code>hold</code> Call <em>deliver</em> (falsy) or store the change notification
to be delivered upon a call to deliverChangeRecords (truthy)</p>

<p><code>returns</code> {Object|*} <code>this</code> or calls deliverChangeRecords</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">set</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">set</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">hold</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">object</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-156">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-156">&#182;</a>               </div>               <p>did this key exist already</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">obj</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;updated&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-157">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-157">&#182;</a>               </div>               <p>then there is an oldValue</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">obj</span><span class="p">.</span><span class="nx">oldValue</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
    <span class="p">}</span> <span class="k">else</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;new&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-158">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-158">&#182;</a>               </div>               <p>now actually set the value</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">changeRecords</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-159">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-159">&#182;</a>               </div>               <p>call the observers or not</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="nx">hold</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">deliverChangeRecords</span><span class="p">();</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-160">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-160">&#182;</a>               </div>               <h3>setPath</h3>

<p>Overrides sudo.Base.setPath to check for observers.
Change records originating from a <code>setPath</code> operation
send back the passed in <code>path</code> as <code>name</code> as well as the
top level object being observed (this observable's data).
this allows for easy filtering either manually or via a 
<code>change delegate</code></p>

<p><code>param</code> {String} <code>path</code>
<code>param</code> {<em>} <code>value</code>
<code>param</code> {Bool} <code>hold</code> Call _deliver_ (falsy) or store the change notification
to be delivered upon a call to deliverChangeRecords (truthy)
<code>returns</code> {Object|</em>} <code>this</code> or calls deliverChangeRecords</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">setPath</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">setPath</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">value</span><span class="p">,</span> <span class="nx">hold</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">curr</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="nx">path</span><span class="p">,</span> <span class="nx">object</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">},</span>
      <span class="nx">p</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">),</span> <span class="nx">key</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">key</span><span class="p">;</span> <span class="nx">p</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">key</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">shift</span><span class="p">());)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">p</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-161">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-161">&#182;</a>               </div>               <p>reached the last refinement, pre-existing?</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span> <span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">curr</span><span class="p">)</span> <span class="p">{</span>
          <span class="nx">obj</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;updated&#39;</span><span class="p">;</span>
          <span class="nx">obj</span><span class="p">.</span><span class="nx">oldValue</span> <span class="o">=</span> <span class="nx">curr</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
        <span class="p">}</span> <span class="k">else</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="s1">&#39;new&#39;</span><span class="p">;</span>
        <span class="nx">curr</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="nx">value</span><span class="p">;</span>
      <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">curr</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="p">{</span>
        <span class="nx">curr</span> <span class="o">=</span> <span class="nx">curr</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">curr</span> <span class="o">=</span> <span class="nx">curr</span><span class="p">[</span><span class="nx">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{};</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">changeRecords</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-162">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-162">&#182;</a>               </div>               <p>call all observers or not</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="nx">hold</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">deliverChangeRecords</span><span class="p">();</span>
  <span class="p">},</span> </pre></div>             </td>           </tr>                               <tr id="section-163">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-163">&#182;</a>               </div>               <h3>sets</h3>

<p>Overrides Base.sets to hold the call to <em>deliver</em> until
all operations are done</p>

<p><code>returns</code> {Object|*} <code>this</code> or calls deliverChangeRecords</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">sets</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">sets</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">hold</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">k</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">obj</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">k</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">k</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="nx">k</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">k</span><span class="p">[</span><span class="nx">i</span><span class="p">]],</span> <span class="kc">true</span><span class="p">)</span> <span class="o">:</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">setPath</span><span class="p">(</span><span class="nx">k</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">k</span><span class="p">[</span><span class="nx">i</span><span class="p">]],</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">hold</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">deliverChangeRecords</span><span class="p">();</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-164">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-164">&#182;</a>               </div>               <h3>unobserve</h3>

<p>Remove a particular callback from this observable</p>

<p><code>param</code> {Function} the function passed in to <code>observe</code>
<code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">unobserve</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">unobserve</span><span class="p">(</span><span class="nx">fn</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">cb</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">callbacks</span><span class="p">,</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">cb</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">fn</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">i</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="nx">cb</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-165">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-165">&#182;</a>               </div>               <h3>unobserves</h3>

<p>Allow an array of callbacks to be unregistered as changeRecord recipients</p>

<p><code>param</code> {Array} ary
<code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">unobserves</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">unobserves</span><span class="p">(</span><span class="nx">ary</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ary</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">unobserve</span><span class="p">(</span><span class="nx">ary</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-166">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-166">&#182;</a>               </div>               <h3>unset</h3>

<p>Overrides sudo.Base.unset to check for observers</p>

<p><code>param</code> {String} <code>key</code>. The name of the key
<code>param</code> {Bool} <code>hold</code></p>

<p><code>returns</code> {Object|*} <code>this</code> or calls deliverChangeRecords</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">unset</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">unset</span><span class="p">(</span><span class="nx">key</span><span class="p">,</span> <span class="nx">hold</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">object</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;deleted&#39;</span><span class="p">},</span> 
      <span class="nx">val</span> <span class="o">=</span> <span class="o">!!</span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
    <span class="k">delete</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span></pre></div>             </td>           </tr>                               <tr id="section-167">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-167">&#182;</a>               </div>               <p>call the observers if there was a val to delete</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_unset_</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">hold</span><span class="p">);</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-168">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-168">&#182;</a>               </div>               <h3><em>unset</em></h3>

<p>Helper for the unset functions</p>

<p><code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">_unset_</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">_unset_</span><span class="p">(</span><span class="nx">o</span><span class="p">,</span> <span class="nx">v</span><span class="p">,</span> <span class="nx">h</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">changeRecords</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">o</span><span class="p">);</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">h</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">deliverChangeRecords</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-169">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-169">&#182;</a>               </div>               <h3>setPath</h3>

<p>Overrides sudo.Base.unsetPath to check for observers</p>

<p><code>param</code> {String} <code>path</code>
<code>param</code> {*} <code>value</code>
<code>param</code> {bool} <code>hold</code></p>

<p><code>returns</code> {Object|*} <code>this</code> or calls deliverChangeRecords</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">unsetPath</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">unsetPath</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="nx">hold</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="nx">path</span><span class="p">,</span> <span class="nx">object</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;deleted&#39;</span><span class="p">},</span> 
      <span class="nx">curr</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">p</span> <span class="o">=</span> <span class="nx">path</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">),</span> 
      <span class="nx">key</span><span class="p">,</span> <span class="nx">val</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">key</span><span class="p">;</span> <span class="nx">p</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="nx">key</span> <span class="o">=</span> <span class="nx">p</span><span class="p">.</span><span class="nx">shift</span><span class="p">());)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">p</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-170">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-170">&#182;</a>               </div>               <p>reached the last refinement</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">val</span> <span class="o">=</span> <span class="o">!!</span><span class="nx">curr</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
        <span class="k">delete</span> <span class="nx">curr</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-171">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-171">&#182;</a>               </div>               <p>this can obviously fail, but can be prevented by checking
with <code>getPath</code> first.</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="nx">curr</span> <span class="o">=</span> <span class="nx">curr</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_unset_</span><span class="p">(</span><span class="nx">obj</span><span class="p">,</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">hold</span><span class="p">);</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-172">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-172">&#182;</a>               </div>               <h3>unsets</h3>

<p>Override of Base.unsets to hold the call to <em>deliver</em> until done</p>

<p><code>param</code> ary 
<code>param</code> hold
<code>returns</code> {Object|*} <code>this</code> or calls deliverChangeRecords</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">unsets</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">unsets</span><span class="p">(</span><span class="nx">ary</span><span class="p">,</span> <span class="nx">hold</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">i</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ary</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">ary</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">?</span> <span class="k">this</span><span class="p">.</span><span class="nx">unset</span><span class="p">(</span><span class="nx">k</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="kc">true</span><span class="p">)</span> <span class="o">:</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">unsetPath</span><span class="p">(</span><span class="nx">k</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="kc">true</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">hold</span><span class="p">)</span> <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">deliverChangeRecords</span><span class="p">();</span> 
  <span class="p">}</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-173">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-173">&#182;</a>               </div>               <h2>Listener Extension Object</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-174">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-174">&#182;</a>               </div>               <p>Handles event binding/unbinding via an events hash in the form:
event(s): {
type: 'methodName' (or function)
type2: {
    sel: 'methodName',
    otherSel: function
},
type3: {
    sel: {
        fn: 'methodName' (or function),
        data: {...},
        capture: true
    }
}
}
This hash will be searched for via <code>this.get('event(s)')</code>.
About the hash:</p>

<p>A. type -> Compatible DOM event type
B. event(s)[type] === {string} || {function} (no delegation or data)
     1. If a {string}, name of a method on this object. Will be 
            converted to a reference to that method with scope bound to <code>this</code>.
     2. If a {function} left as is with no scope manipulation. 
C. event(s)[type] === {object}
    1. sel -> Optional CSS selector used to delegate events
    2. type[sel] -> 
        a. If a {string}, name of a method on this object. Will be 
             converted to a reference to that method with scope bound to <code>this</code>.
        b. If a {function} left as is with no scope manipulation. 
        c. If an object, 'fn' key located and treated as 1 or 2 above,
             'data' key located and appended to the <code>Event</code> before being 
             passed to the callback</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">extensions</span><span class="p">.</span><span class="nx">listener</span> <span class="o">=</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-175">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-175">&#182;</a>               </div>               <h3><em>addOrRemove</em></h3>

<p>All the relevant pieces have been accumulated, now either add or remove the 
Listener to/from the element</p>

<p><code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">_addOrRemove_</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">_addOrRemove_</span><span class="p">(</span><span class="nx">which</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">handler</span><span class="p">,</span> <span class="nx">capture</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">el</span><span class="p">[</span><span class="nx">which</span> <span class="o">?</span> <span class="s1">&#39;addEventListener&#39;</span> <span class="o">:</span> <span class="s1">&#39;removeEventListener&#39;</span><span class="p">](</span><span class="nx">type</span><span class="p">,</span> <span class="nx">handler</span><span class="p">,</span> <span class="nx">capture</span><span class="p">);</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-176">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-176">&#182;</a>               </div>               <h3>bindEvents</h3>

<p>Bind the events in the data store to this object's el, observing the 
options there</p>

<p><code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">bindEvents</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">bindEvents</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">hash</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-177">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-177">&#182;</a>               </div>               <p>because you must pass the same ref to <code>unbind</code></p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">_predicate_</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">_predicate_</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">predicate</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="k">if</span><span class="p">((</span><span class="nx">hash</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">event</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">events</span><span class="p">))</span> <span class="k">this</span><span class="p">.</span><span class="nx">_handleEvents_</span><span class="p">(</span><span class="nx">hash</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-178">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-178">&#182;</a>               </div>               <h3><em>handleEvents</em></h3>

<p>Get each event type to be observed and pass them to <em>handleType</em>_
with their options</p>

<p><code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">_handleEvents_</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">_handleEvents_</span><span class="p">(</span><span class="nx">hash</span><span class="p">,</span> <span class="nx">which</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">types</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">hash</span><span class="p">),</span> <span class="nx">i</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">types</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">this</span><span class="p">.</span><span class="nx">_handleType_</span><span class="p">(</span><span class="nx">types</span><span class="p">[</span><span class="nx">i</span><span class="p">],</span> <span class="nx">hash</span><span class="p">,</span> <span class="nx">which</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-179">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-179">&#182;</a>               </div>               <h3><em>handleType</em></h3>

<p>Normalizes the various forms that event data may be in. Works
in conjunction with <code>_addOrRemove_</code> and <code>predicate</code> to correctly
prepare methods for adding <strong>and removing</strong> event Listeners.</p>

<p><code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">_handleType_</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">_handleEvent_</span><span class="p">(</span><span class="nx">type</span><span class="p">,</span> <span class="nx">hash</span><span class="p">,</span> <span class="nx">which</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">handler</span> <span class="o">=</span> <span class="nx">hash</span><span class="p">[</span><span class="nx">type</span><span class="p">],</span> <span class="nx">handlerType</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">handler</span><span class="p">,</span> 
    <span class="nx">selectors</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">nHandler</span><span class="p">,</span> <span class="nx">nHandlerType</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-180">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-180">&#182;</a>               </div>               <p>handler is already a function, (un)bind it</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="nx">handlerType</span> <span class="o">===</span> <span class="s1">&#39;function&#39;</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">_addOrRemove_</span><span class="p">(</span><span class="nx">which</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">handler</span><span class="p">);</span>
    <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="nx">handlerType</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-181">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-181">&#182;</a>               </div>               <p>morph the name into a bound reference</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">hash</span><span class="p">[</span><span class="nx">type</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="nx">handler</span><span class="p">].</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-182">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-182">&#182;</a>               </div>               <p>bind it</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">this</span><span class="p">.</span><span class="nx">_addOrRemove_</span><span class="p">(</span><span class="nx">which</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="nx">hash</span><span class="p">[</span><span class="nx">type</span><span class="p">]);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// nested object(s)</span>
      <span class="nx">selectors</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">handler</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-183">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-183">&#182;</a>               </div>               <p>the fn still needs to be bound for the predicate</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">selectors</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">selector</span> <span class="o">=</span> <span class="nx">selectors</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
        <span class="nx">nHandler</span> <span class="o">=</span> <span class="nx">handler</span><span class="p">[</span><span class="nx">selector</span><span class="p">];</span> <span class="nx">nHandlerType</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">nHandler</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-184">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-184">&#182;</a>               </div>               <p>type3 above - may have sel, data and 'capture'</p>             </td>             <td class="code">               <div class="highlight"><pre>        <span class="k">if</span><span class="p">(</span><span class="nx">nHandlerType</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span> 
          <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">nHandler</span><span class="p">.</span><span class="nx">fn</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">nHandler</span><span class="p">.</span><span class="nx">fn</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="nx">nHandler</span><span class="p">.</span><span class="nx">fn</span><span class="p">].</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">this</span><span class="p">.</span><span class="nx">_addOrRemove_</span><span class="p">(</span><span class="nx">which</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_predicate_</span><span class="p">,</span> <span class="nx">nHandler</span><span class="p">.</span><span class="nx">capture</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-185">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-185">&#182;</a>               </div>               <p>this form (type2 above) has a sel - but no data or 'capture'</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="k">if</span><span class="p">(</span><span class="nx">nHandlerType</span> <span class="o">===</span> <span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="nx">hash</span><span class="p">[</span><span class="nx">type</span><span class="p">][</span><span class="nx">selector</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">[</span><span class="nx">nHandler</span><span class="p">].</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-186">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-186">&#182;</a>               </div>               <p>the predicate will call the fn if sel match is made</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="k">this</span><span class="p">.</span><span class="nx">_addOrRemove_</span><span class="p">(</span><span class="nx">which</span><span class="p">,</span> <span class="nx">type</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">_predicate_</span><span class="p">);</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-187">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-187">&#182;</a>               </div>               <h3>predicate</h3>

<p>When binding events, if a a <code>selector</code> (or <code>data</code>) is found, the Listener
will bind this method as the callback. Serving as the 'first step' in a process
that will:
  1. Appended the <code>data</code> to the <code>event</code> object if <code>data</code> is present. 
  2. If <code>sel</code> is indicated, Compare the <code>event.target</code> to the item(s) returned fom
     a querySelectorAll operation on this object's <code>el</code>, looking for a match.
When complete, pass the <code>event</code> to the desired callback (or don't), as per <code>bindEvents</code>.</p>

<p><strong>Notes</strong>
This method could be written (along with <em>handleType</em>)to create closures for the 
needed data in the event hash rather than looking it up. This would not be
without concerns however, such as memory leaks.</p>

<p>Also, the querySelectorAll operation could be done at <code>_handleType_</code> and stored
in the hash. If the fact that 'QSA' returns a 'live' NodeList proves to be reliable
that may be a more efficient solution, but 'templated' views may be problematic.</p>

<p><code>param</code> {event} <code>e</code>. The DOM event
<code>returns</code> {*} call to the indicated method/function</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">predicate</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">predicate</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">hash</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">event</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">events</span><span class="p">,</span>
      <span class="nx">type</span> <span class="o">=</span> <span class="nx">hash</span><span class="p">[</span><span class="nx">e</span><span class="p">.</span><span class="nx">type</span><span class="p">],</span> <span class="nx">selectors</span><span class="p">,</span> <span class="nx">ary</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">selector</span><span class="p">,</span> <span class="nx">handler</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">type</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">selectors</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">type</span><span class="p">);</span>
      <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">selectors</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">selector</span> <span class="o">=</span> <span class="nx">selectors</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span> <span class="nx">handler</span> <span class="o">=</span> <span class="nx">type</span><span class="p">[</span><span class="nx">selector</span><span class="p">];</span>
        <span class="nx">ary</span> <span class="o">=</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$$</span><span class="p">(</span><span class="nx">selector</span><span class="p">));</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">ary</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">)</span> <span class="o">!==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-188">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-188">&#182;</a>               </div>               <p>time to call the methods</p>             </td>             <td class="code">               <div class="highlight"><pre>          <span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">handler</span> <span class="o">===</span> <span class="s1">&#39;object&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="nx">handler</span><span class="p">.</span><span class="nx">data</span><span class="p">)</span> <span class="nx">e</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="nx">handler</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
            <span class="k">return</span> <span class="nx">handler</span><span class="p">.</span><span class="nx">fn</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
          <span class="p">}</span> <span class="k">else</span> <span class="k">return</span> <span class="nx">handler</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span> 
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">},</span></pre></div>             </td>           </tr>                               <tr id="section-189">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-189">&#182;</a>               </div>               <h3>unbindEvents</h3>

<p>Unbind the events in the data store from this object's $el</p>

<p><code>returns</code> {Object} <code>this</code></p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nx">unbindEvents</span><span class="o">:</span> <span class="kd">function</span> <span class="nx">unbindEvents</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">hash</span><span class="p">;</span>
    <span class="k">if</span><span class="p">((</span><span class="nx">hash</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">event</span> <span class="o">||</span> <span class="k">this</span><span class="p">.</span><span class="nx">model</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">events</span><span class="p">))</span> <span class="k">this</span><span class="p">.</span><span class="nx">_handleEvents_</span><span class="p">(</span><span class="nx">hash</span><span class="p">);</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-190">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-190">&#182;</a>               </div>               <h2>Change Delegate</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-191">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-191">&#182;</a>               </div>               <p>Delegates, if present, can override or extend the behavior
of objects. The change delegate is specifically designed to
filter change records from an Observable instance and only forward
the ones matching a given <code>filters</code> criteria (key or path).
The forwarded messages will be sent to the specified method
on the delegates <code>delegator</code> (bound to the <em>delegator</em> scope)</p>

<p><code>param</code> {Object} data</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">delegates</span><span class="p">.</span><span class="nx">Change</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">construct</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-192">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-192">&#182;</a>               </div>               <p>Delegates inherit from Model</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">delegates</span><span class="p">.</span><span class="nx">Change</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">sudo</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-193">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-193">&#182;</a>               </div>               <p>Change records are delivered here and filtered, calling any matching
methods specified in `this.get('filters').</p>

<p><code>returns</code> {Object} a call to the specified <em>delegator</em> method, passing
a hash containing:
1. the <code>type</code> of Change
2. the value located at the key/path
3. the <code>oldValue</code> of the key if present</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">delegates</span><span class="p">.</span><span class="nx">Change</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">filter</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">filter</span><span class="p">(</span><span class="nx">change</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">filters</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">filters</span><span class="p">,</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">change</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">obj</span> <span class="o">=</span> <span class="p">{};</span></pre></div>             </td>           </tr>                               <tr id="section-194">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-194">&#182;</a>               </div>               <p>does my delegator care about this?</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="k">if</span><span class="p">(</span><span class="nx">name</span> <span class="k">in</span> <span class="nx">filters</span> <span class="o">&amp;&amp;</span> <span class="nx">filters</span><span class="p">.</span><span class="nx">hasOwnProperty</span><span class="p">(</span><span class="nx">name</span><span class="p">))</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-195">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-195">&#182;</a>               </div>               <p>assemble the object to return to the method</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="nx">obj</span><span class="p">.</span><span class="nx">type</span> <span class="o">=</span> <span class="nx">change</span><span class="p">.</span><span class="nx">type</span><span class="p">;</span>
    <span class="nx">obj</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">name</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span> <span class="o">?</span> <span class="nx">change</span><span class="p">.</span><span class="nx">object</span><span class="p">[</span><span class="nx">change</span><span class="p">.</span><span class="nx">name</span><span class="p">]</span> <span class="o">:</span>
      <span class="nx">sudo</span><span class="p">.</span><span class="nx">getPath</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">change</span><span class="p">.</span><span class="nx">object</span><span class="p">);</span>
    <span class="nx">obj</span><span class="p">.</span><span class="nx">oldValue</span> <span class="o">=</span> <span class="nx">change</span><span class="p">.</span><span class="nx">oldValue</span><span class="p">;</span>
    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">delegator</span><span class="p">[</span><span class="nx">filters</span><span class="p">[</span><span class="nx">name</span><span class="p">]].</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">delegator</span><span class="p">,</span> <span class="nx">obj</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-196">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-196">&#182;</a>               </div>               <p><code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">delegates</span><span class="p">.</span><span class="nx">Change</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">role</span> <span class="o">=</span> <span class="s1">&#39;change&#39;</span><span class="p">;</span></pre></div>             </td>           </tr>                               <tr id="section-197">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-197">&#182;</a>               </div>               <h2>Data Delegate</h2>             </td>             <td class="code">               <div class="highlight"><pre></pre></div>             </td>           </tr>                               <tr id="section-198">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-198">&#182;</a>               </div>               <p>Delegates, if present, can extend the behavior
of objects, lessening the need for subclassing. 
The data delegate is specifically designed to
filter through an object, looking for specified keys or paths
and returning values for those if found</p>

<p><code>param</code> {Object} data
<code>returns</code> {*} the value found at the specified key/path if found</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">delegates</span><span class="p">.</span><span class="nx">Data</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">construct</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-199">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-199">&#182;</a>               </div>               <p>inherits from Model</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">delegates</span><span class="p">.</span><span class="nx">Data</span><span class="p">.</span><span class="nx">prototype</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="nx">sudo</span><span class="p">.</span><span class="nx">Model</span><span class="p">.</span><span class="nx">prototype</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-200">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-200">&#182;</a>               </div>               <h3>filter</h3>

<p>iterates over a given object literal and returns a value (if present)
located at a given key or path</p>

<p><code>param</code> {Object} <code>obj</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">delegates</span><span class="p">.</span><span class="nx">Data</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">filter</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">filters</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">filters</span><span class="p">,</span>
    <span class="nx">ary</span> <span class="o">=</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">filters</span><span class="p">),</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">o</span><span class="p">,</span> <span class="nx">k</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">ary</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">key</span> <span class="o">=</span> <span class="nx">ary</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span></pre></div>             </td>           </tr>                               <tr id="section-201">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-201">&#182;</a>               </div>               <p>keys and paths need different handling</p>             </td>             <td class="code">               <div class="highlight"><pre>    <span class="k">if</span><span class="p">(</span><span class="nx">key</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">===</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">key</span> <span class="k">in</span> <span class="nx">obj</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">delegator</span><span class="p">[</span><span class="nx">filters</span><span class="p">[</span><span class="nx">key</span><span class="p">]].</span><span class="nx">call</span><span class="p">(</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">delegator</span><span class="p">,</span> <span class="nx">obj</span><span class="p">[</span><span class="nx">key</span><span class="p">]);</span>  
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span></pre></div>             </td>           </tr>                               <tr id="section-202">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-202">&#182;</a>               </div>               <p>the chars after the last refinement are the key we need to check for</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">k</span> <span class="o">=</span> <span class="nx">key</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">key</span><span class="p">.</span><span class="nx">lastIndexOf</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span></pre></div>             </td>           </tr>                               <tr id="section-203">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-203">&#182;</a>               </div>               <p>and the ones prior are the object</p>             </td>             <td class="code">               <div class="highlight"><pre>      <span class="nx">o</span> <span class="o">=</span> <span class="nx">sudo</span><span class="p">.</span><span class="nx">getPath</span><span class="p">(</span><span class="nx">key</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">key</span><span class="p">.</span><span class="nx">lastIndexOf</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)),</span> <span class="nx">obj</span><span class="p">);</span>
      <span class="k">if</span><span class="p">(</span><span class="nx">o</span> <span class="o">&amp;&amp;</span> <span class="nx">k</span> <span class="k">in</span> <span class="nx">o</span><span class="p">)</span> <span class="k">this</span><span class="p">.</span><span class="nx">delegator</span><span class="p">[</span><span class="nx">filters</span><span class="p">[</span><span class="nx">key</span><span class="p">]].</span><span class="nx">call</span><span class="p">(</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">delegator</span><span class="p">,</span> <span class="nx">o</span><span class="p">[</span><span class="nx">k</span><span class="p">]);</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">};</span></pre></div>             </td>           </tr>                               <tr id="section-204">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-204">&#182;</a>               </div>               <p><code>private</code></p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nx">sudo</span><span class="p">.</span><span class="nx">delegates</span><span class="p">.</span><span class="nx">Data</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">role</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span><span class="p">;</span>

<span class="nx">sudo</span><span class="p">.</span><span class="nx">version</span> <span class="o">=</span> <span class="s2">&quot;0.9.4&quot;</span><span class="p">;</span>
<span class="nb">window</span><span class="p">.</span><span class="nx">sudo</span> <span class="o">=</span> <span class="nx">sudo</span><span class="p">;</span>
<span class="k">if</span><span class="p">(</span><span class="k">typeof</span> <span class="nb">window</span><span class="p">.</span><span class="nx">_</span> <span class="o">===</span> <span class="s2">&quot;undefined&quot;</span><span class="p">)</span> <span class="nb">window</span><span class="p">.</span><span class="nx">_</span> <span class="o">=</span> <span class="nx">sudo</span><span class="p">;</span>
<span class="p">}).</span><span class="nx">call</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">);</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 